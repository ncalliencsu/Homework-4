---
title: "Reading Delimited Data"
format: html
toc: TRUE
editor_options: 
  chunk_output_type: inline
---

> Glass Data\
> 1. Read this data into R directly from the URL using functions from the tidyverse. Notice that the data doesn’t include column names - add those (in a manner of your choosing). Print out the tibble (just call the object name).

```{r Glass Data - Question 1}
library(tidyverse)

glass_data <- read_csv("https://www4.stat.ncsu.edu/~online/datasets/glass.data", 
                       col_names = c("Id", "RI", "Na", "Mg", "Al", "Si", "K", "Ca", "Ba", "Fe", "Type_of_Glass")
)
glass_data
```

> 2.  Start a chain that would overwrite the Type_of_glass variable using mutate(). Create a character string version (that is, replace 1 with “building_windows_float_processed”, 2 with “building_win. . . ”,etc.) instead (see the variable descriptions above to give meaningful values). (If you are familiar with factors, feel free to use that instead of a character string variable - otherwise, think if/then/else via ifelse().)

```{r Glass Data - Question 2}
window_types <- c("building_windows_float_processed", "building_windows_non_float_processed", "vehicle_windows_float_processed", "vehicle_windows_non_float_processed", "containers", "tableware", "headlamps")
glass_data |> mutate(Type_of_Glass = factor(Type_of_Glass, ordered = TRUE, levels = 1:7, labels = window_types ))
                                                                                       
```

> 3.  Continue your chain and keep only observations where the Fe variable is less than 0.2 and the Type of Glass is either “tableware” or “headlamps”.

```{r Glass Data - Question 3}
window_types <- c("building_windows_float_processed", "building_windows_non_float_processed", "vehicle_windows_float_processed", "vehicle_windows_non_float_processed", "containers", "tableware", "headlamps")
glass_data |>
  mutate(Type_of_Glass = factor(Type_of_Glass, ordered = TRUE, levels = 1:7, labels = window_types)) |> 
  filter(Fe < 0.2 & Type_of_Glass %in% c('tableware', 'headlamps'))
```

> Yeast Data\
> 1. Read this data into R directly from the URL using functions from the tidyverse. Notice that the data doesn’t include column names - add those (in a manner of your choosing). Print out the tibble (just call the object name).

```{r Yeast Data - Question 1}
library(tidyverse)

yeast_data <- read_table("https://www4.stat.ncsu.edu/~online/datasets/yeast.data", 
                       col_names = c("seq_name", "mcg", "gvh", "alm", "mit", "erl", "pox", "vac", "nuc", "class")
)
yeast_data
```

> 2.  Start a chain that removes the seq_name and nuc columns.

```{r Yeast Data - Question 2}
yeast_data |> select(-seq_name, -nuc)
```

> 3.  Continue your chain to add columns corresponding to the mean and median of each numeric variable (mcg, gvh, alm, mit, erl, pox, and vac) at each class grouping (see the across() function as we did in the dplyr video!).

```{r Yeast Data - Question 3}
yeast_data |> select(-seq_name, -nuc) |> 
  group_by(class) |>
  mutate(across(where(is.numeric), list(mean = mean, median = median),
 .names = "{.col}_{.fn}"))

```
